@page "/AppointmentHome"
@using DUPSS.API.Models.DTOs
@using DUPSS.Web.Components.Service
@inject UserApiService UserService

<main class="appointment-home-container">
    <header class="appointment-home-header text-center">
        <div class="appointment-home-icon">📅</div>
        <h2 class="appointment-home-title">Welcome to the Appointment Center</h2>
        <p class="appointment-home-subtitle">
            Book confidential 1-on-1 sessions with our professional consultants
        </p>
    </header>

    <section class="appointment-home-info mb-5">
        <h3>💡 What is this feature?</h3>
        <p>
            The Appointment feature allows members to schedule confidential 1-on-1 online consultation sessions.
            Each session lasts approximately <strong>30 minutes</strong>. You can:
        </p>
        <ul>
            <li>🔍 <strong>Choose a consultant manually</strong> from our list</li>
            <li>🤖 <strong>Let the system auto-assign</strong> one based on your selected time</li>
        </ul>
        <p>
            Before confirming, feel free to describe your topic so our consultant can better assist you.
        </p>
    </section>

    <section class="appointment-home-info mb-5">
        <h3>🕐 Consultant Availability</h3>
        <p>Most consultants are available at these time slots:</p>
        <ul>
            <li><strong>Morning:</strong> 09:00 – 11:30</li>
            <li><strong>Afternoon:</strong> 13:30 – 17:00</li>
            <li><strong>Evening (most popular):</strong> 19:00 – 21:00</li>
        </ul>
        <p>Choose time slots in these ranges for faster approval.</p>
    </section>

    <section class="appointment-home-info mb-5">
        <h3>🧠 Popular Consultation Topics</h3>
        <ul>
            <li>🚭 Preventing Drug Use</li>
            <li>💬 Mental Health & Stress Management</li>
            <li>🏫 School and Academic Guidance</li>
            <li>👥 Peer Pressure & Social Relationships</li>
            <li>🏠 Family Communication</li>
        </ul>
    </section>

    <section class="mb-5">
        <h3 class="mb-4">👨‍⚕️ Our Available Consultants</h3>

        @if (consultants == null)
        {
            <p>Loading consultants...</p>
        }
        else if (!consultants.Any())
        {
            <p>No consultants available at the moment.</p>
        }
        else
        {
            <div class="row row-cols-md-1 row-cols-sm-2 row-cols-md-3 row-cols-md-4 g-12">
                @foreach (var consultant in consultants)
                {
                    <div class="col">
                        <article class="card h-100 shadow-sm border-0" style="border-radius:1.25rem;">
                            <div class="card-body d-flex flex-column align-items-start">
                                <h5 class="card-title mb-2">
                                    @consultant.Username
                                </h5>
                                <p class="card-text mb-1">
                                    <strong>Email:</strong> @consultant.Email <br />
                                    <strong>Phone:</strong> @consultant.PhoneNumber
                                </p>
                            </div>
                        </article>
                    </div>
                }
            </div>
        }
    </section>

    <footer class="appointment-home-footer text-center mt-4">
        <a href="/Appointment" class="appointment-home-cta me-3">
            📖 View Your Appointment History
        </a>
        <a href="/BookAppointment" class="appointment-home-cta"
           style="background:linear-gradient(90deg,#22c55e 60%,#4ade80 100%)">
            📌 Book an Appointment Now
        </a>
    </footer>
</main>

@code {
    private List<UserDTO>? consultants;

    protected override async Task OnInitializedAsync()
    {
        consultants = await UserService.GetConsultantsAsync();
    }
}
