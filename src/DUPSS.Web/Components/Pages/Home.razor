@page "/"
@inject IJSRuntime JS
<PageTitle>Home</PageTitle>

@* Demo for Blazor Server with Supabase Authentication *@

@* <AuthorizeView>
    <Authorized>
        <h3>Hello, @context.User.FindFirst(System.Security.Claims.ClaimTypes.Name)?.Value</h3>
        <p>Role: @context.User.FindFirst(System.Security.Claims.ClaimTypes.Role)?.Value</p>
    </Authorized>
    <NotAuthorized>
        <h3>Welcome, Guest! Please <a href="/login">log in</a> to personalize your experience.</h3>
    </NotAuthorized>
</AuthorizeView> *@

<div class="container-fluid px-5 py-4">
    <section class="hero-section">
        <div class="hero-content">
        </div>

        <div class="hero-card">
            <h2>A Journey of Overcoming Temptation</h2>
            <p class="quote">"I didn’t think one small decision could change everything—until it did."</p>


            <NavLink href="/inspiring-story" class="btn-read-story">
                READ THE STORY <span class="arrow">→</span>
            </NavLink>
        </div>

    </section>

    <div class="row ">
        <div class="col-md-3">
            <h5 class="fw-semibold mb-5" style="color: #1b6ec2">Blog Topics</h5>
            <ul class="list-unstyled">
                <li class="py-2">Health & Wellness</li>
                <li class="py-2">Education</li>
                <li class="py-2">Science & Research</li>
                <li class="py-2">Policy & Advocacy</li>
                <li class="py-2">Events & Campaigns</li>
                <li class="py-2">Social Life</li>
            </ul>
        </div>

        <div class="col-md-9 blog-card">
            <h6 class="text-primary mb-3">Trending Topics</h6>
            <div class="d-flex flex-column gap-5 ">

                <div class="col-md-10">
                    <div class="card h-100 shadow-sm">
                        <div class="row g-5">
                            <div class="col-md-8 order-md-1">
                                <div class="card-body">
                                    <h5 class="card-title">Know the Facts: How Education Can Prevent Drug Abuse</h5>
                                    <p class="card-text text-muted">Misinformation fuels risky behavior. Learn how evidence-based drug education in schools and communities empowers young people to make informed, healthy choices.</p>
                                    <span class="badge bg-secondary">Education</span>
                                    <div class="mt-2 text-muted small">By Mark Tuchel • <span style="color: #0892ff;">7 min read</span> </div>
                                </div>
                            </div>

                            <div class="col-md-4 order-md-2">
                                <img src="images/1.jpg" class="img-fluid h-100" style="object-fit: cover;" alt="...">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-10">
                    <div class="card h-100 shadow-sm">
                        <div class="row g-5">
                            <div class="col-md-8 order-md-1">
                                <div class="card-body">
                                    <h5 class="card-title">Building Resilience: Protective Factors Against Substance Use</h5>
                                    <p class="card-text text-muted">Strong family bonds, peer support, and extracurricular activities can shield teens from addiction. Discover practical ways to foster resilience in your community.</p>
                                    <span class="badge bg-secondary">Health & Wellness</span>
                                    <div class="mt-2 text-muted small">By Harry Duval • <span style="color: #0892ff;">4 min read</span></div>
                                </div>
                            </div>

                            <div class="col-md-4 order-md-2">
                                <img src="images/1.jpg" class="img-fluid h-100" style="object-fit: cover;" alt="...">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <section class="new-hero-section">
        <div class="container new-hero-container">
            <h1 class="typewrite">
                @*put letter r to enable effect*@
                Every individual and community has the ability to protect themselves from the risks of drug use and plays a vital role in building a healthier, safer society.

            </h1>

            <div class="image-carousel-wrapper">
                <button class="carousel-control-image prev-btn-image">
                    <span class="arrow-icon">&lt;</span>
                </button>

                <div class="carousel-image-slides">
                    <div class="carousel-image-slide active">
                        <img src="images/1.jpg" alt="Câu chuyện 1" class="carousel-image" />
                        <img src="images/2.jpg" alt="Câu chuyện 2" class="carousel-image" />
                    </div>

                    <div class="carousel-image-slide">
                        <img src="images/3.jpg" alt="Câu chuyện 3" class="carousel-image" />
                        <img src="images/4.jpg" alt="Câu chuyện 4" class="carousel-image" />
                    </div>

                </div>
                

                <button class="carousel-control-image next-btn-image">
                    <span class="arrow-icon">&gt;</span>
                </button>
                
            </div>
        </div>
    </section>


    <div class="subscribe-container">
        <div class="left">
            <h4>Stay up to date</h4>
            <h2>Get Started</h2>
            <form>
                <input type="email" placeholder="Enter your email.." required />
                <button type="submit">Register now</button>
            </form>
            <p>*You can unsubscribe anytime</p>
        </div>
        <div class="right"></div>
    </div>

    <footer class="main-footer mt-10">
        <canvas id="rainCanvas" class="rain-canvas"></canvas>

        <div class=" footer-content-wrapper ">
            <div class="footer-section footer-logo-section col-1">
                <img src="images/logo.png" alt="Logo" class="footer-logo" />
                <p class="footer-copyright">Copyright © ALPHA</p>
            </div>

            <div class="footer-section footer-info-section text-center col-2">
                <h5 class="footer-heading">OUR INFORMATION</h5>
                <p>Address: Phuoc Hiep</p>
                <p>Contact number: 090 538 4233</p>
                <p>Email: abcd@fgmail.com</p>
            </div>

            @* <div class="footer-section footer-subscribe-section col-10">
            <div class="subscribe-box">
                <h4 class="subscribe-heading">Stay up to date</h4>
                <p class="subscribe-text">Get Started</p>
                <div class="input-group subscribe-input-group">
                    <input type="email" class="form-control" placeholder="Enter your email" aria-label="Enter your email" />
                    <button class="btn btn-primary" type="button">Register now</button>
                </div>
                <small class="subscribe-note">*You can unsubscribe anytime</small>
            </div>

            <div class="footer-section footer-info-section text-center col-2">
                <h5 class="footer-heading">OUR INFORMATION</h5>
                <p>Address: Phuoc Hiep</p>
                <p>Contact number: 090 538 4233</p>
                <p>Email: abcd@fgmail.com</p>
            </div>

            @* <div class="footer-section footer-subscribe-section col-10">
                <div class="subscribe-box">
                    <h4 class="subscribe-heading">Stay up to date</h4>
                    <p class="subscribe-text">Get Started</p>
                    <div class="input-group subscribe-input-group">
                        <input type="email" class="form-control" placeholder="Enter your email" aria-label="Enter your email" />
                        <button class="btn btn-primary" type="button">Register now</button>
                    </div>
                    <small class="subscribe-note">*You can unsubscribe anytime</small>
                </div>
            </div> *@
        </div>
    </footer>


</div>
@* ---raining effect--- *@
<script>
    (function () {
        function startRain() {
            const canvas = document.getElementById('rainCanvas');
            if (!canvas) return;

            // Set fixed height for the canvas
            canvas.width = canvas.offsetWidth || canvas.parentElement.offsetWidth;
            canvas.height = 120;

            const ctx = canvas.getContext('2d');
            const raindropCount = Math.floor(canvas.width / 7);
            let raindrops = [];

            function createRaindrop() {
                return {
                    x: Math.random() * canvas.width,
                    y: Math.random() * -canvas.height,
                    length: 10 + Math.random() * 15,
                    speed: 2 + Math.random() * 4,
                    opacity: 0.2 + Math.random() * 0.4
                };
            }

            function initRaindrops() {
                raindrops = [];
                for (let i = 0; i < raindropCount; i++) {
                    raindrops.push(createRaindrop());
                }
            }

            function drawRain() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.strokeStyle = 'rgba(173,216,230,0.6)';
                ctx.lineWidth = 1.2;

                for (let drop of raindrops) {
                    ctx.globalAlpha = drop.opacity;
                    ctx.beginPath();
                    ctx.moveTo(drop.x, drop.y);
                    ctx.lineTo(drop.x, drop.y + drop.length);
                    ctx.stroke();

                    drop.y += drop.speed;
                    if (drop.y > canvas.height) {
                        Object.assign(drop, createRaindrop());
                        drop.y = 0;
                    }
                }
                ctx.globalAlpha = 1.0;
                requestAnimationFrame(drawRain);
            }

            initRaindrops();
            drawRain();

            window.addEventListener('resize', () => {
                canvas.width = canvas.offsetWidth || canvas.parentElement.offsetWidth;
                canvas.height = 120;
                initRaindrops();
            });
        }

        // Use a small delay to ensure Blazor has rendered the DOM
        setTimeout(startRain, 500);
    })();
</script>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const slides = document.querySelectorAll('.carousel-image-slide');
        const prevBtn = document.querySelector('.prev-btn-image');
        const nextBtn = document.querySelector('.next-btn-image');
        let currentIndex = 0;

        function showSlide(index) {
            slides.forEach((slide, i) => {
                if (i === index) {
                    slide.classList.add('active');
                } else {
                    slide.classList.remove('active');
                }
            });
        }

        function nextSlide() {
            currentIndex = (currentIndex + 1) % slides.length;
            showSlide(currentIndex);
        }

        function prevSlide() {
            currentIndex = (currentIndex - 1 + slides.length) % slides.length;
            showSlide(currentIndex);
        }

        // Kiểm tra để đảm bảo nút tồn tại trước khi thêm event listener
        if (prevBtn && nextBtn) {
            prevBtn.addEventListener('click', prevSlide);
            nextBtn.addEventListener('click', nextSlide);
            
        }
        // Hiển thị slide đầu tiên khi tải trang
        showSlide(currentIndex);
    });
</script>

@* @code{
    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        await JS.InvokeVoidAsync("startRain", "rainCanvas");
    }
} *@
